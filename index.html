<!DOCTYPE html>
<html lang="id">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0"/>
  <title>Dashboard Backtest Forex</title>
  <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@700;800&family=Roboto:wght@400;500&display=swap" rel="stylesheet">
  <style>
    :root {
      --bg-dark: #111;
      --bg-panel: #222;
      --bg-deep: #1b1b1b;
      --accent: #00ff99;
      --accent-light: #00b33c;
      --text: #eee;
      --profit: #00ff66;
      --loss: #ff3333;
      --border: #444;
      --shadow: rgba(0,255,100,0.06);
    }

    [data-theme="light"] {
      --bg-dark: #f4f4f4;
      --bg-panel: #ffffff;
      --bg-deep: #eaeaea;
      --accent: #00cc66;
      --accent-light: #00b33c;
      --text: #222;
      --profit: #00b33c;
      --loss: #cc0000;
      --border: #ccc;
      --shadow: rgba(0,204,102,0.1);
    }

    * { box-sizing: border-box; margin:0; padding:0; }
    body {
      font-family: 'Roboto', 'Segoe UI', Arial, sans-serif;
      background-color: var(--bg-dark);
      color: var(--text);
      transition: background-color 0.3s, color 0.3s;
      -webkit-font-smoothing: antialiased;
    }

    /* JUDUL UTAMA - PALING ATAS */
    .main-title {
      text-align: center;
      font-family: 'Montserrat', sans-serif;
      font-weight: 800;
      font-size: 2.8rem;
      letter-spacing: 3px;
      margin: 20px 0 10px;
      background: linear-gradient(90deg, #00ff99, #00cc66, #00b33c);
      -webkit-background-clip: text;
      -webkit-text-fill-color: transparent;
      background-clip: text;
      text-shadow: 0 4px 12px rgba(0, 255, 150, 0.2);
      animation: glow 2s ease-in-out infinite alternate;
    }

    @keyframes glow {
      from { text-shadow: 0 4px 12px rgba(0, 255, 150, 0.2); }
      to { text-shadow: 0 6px 20px rgba(0, 255, 150, 0.35); }
    }

    @media (max-width: 600px) {
      .main-title { font-size: 2rem; letter-spacing: 2px; }
    }

    header {
      background-color: var(--bg-panel);
      display: flex;
      justify-content: space-between;
      align-items: center;
      padding: 14px 16px;
      border-bottom: 2px solid rgba(0,255,150,0.05);
      position: sticky;
      top: 0;
      z-index: 50;
      flex-wrap: wrap;
      gap: 10px;
    }

    .tabs {
      display: flex;
      gap: 8px;
    }
    .tabs button {
      background: none;
      border: 1px solid transparent;
      color: var(--text);
      padding: 10px 16px;
      border-radius: 8px;
      cursor: pointer;
      transition: .18s;
      font-size: 15px;
      font-weight: 500;
    }
    .tabs button:hover { transform: translateY(-2px); }
    .tabs button.active {
      background: var(--accent-light);
      color: #000;
      font-weight: 700;
      box-shadow: 0 6px 20px var(--shadow);
    }

    .theme-toggle {
      background: var(--bg-deep);
      border: 1px solid var(--border);
      color: var(--text);
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      font-size: 14px;
      font-weight: 500;
    }

    main {
      padding: 22px;
      max-width: 1100px;
      margin: 0 auto 60px;
    }

    .section { display: none; animation: fadeIn .24s ease; }
    .section.active { display: block; }

    @keyframes fadeIn {
      from { opacity: 0; transform: translateY(8px); }
      to { opacity: 1; transform: translateY(0); }
    }

    .risk-box {
      max-width: 100%;
      margin: 10px auto 18px;
      background-color: var(--bg-deep);
      padding: 18px;
      border-radius: 12px;
      box-shadow: 0 0 10px var(--shadow);
      text-align: center;
    }
    .risk-box input, .risk-box select { width: 40%; margin: 8px; padding: 10px; border-radius: 6px; border: 1px solid var(--border); background: var(--bg-panel); color: var(--text); }
    .value-box {
      display: inline-block;
      background-color: #2a2a2a;
      padding: 8px 14px;
      border-radius: 8px;
      color: var(--accent);
      font-weight: bold;
      margin: 5px;
    }
    [data-theme="light"] .value-box { background-color: #e0f7e9; color: #006633; }

    form.jurnal-form {
      max-width: 720px;
      margin: 8px auto 18px;
      background-color: var(--bg-panel);
      padding: 18px;
      border-radius: 12px;
      box-shadow: 0 0 12px var(--shadow);
    }
    form label {
      display: block;
      margin-top: 10px;
      font-weight: 600;
      color: var(--text);
    }
    input, select, textarea {
      width: 100%;
      padding: 10px;
      margin: 6px 0 10px;
      border: 1px solid var(--border);
      border-radius: 6px;
      background-color: var(--bg-deep);
      color: var(--text);
      font-size: 14px;
    }
    input:focus, select:focus, textarea:focus {
      outline: none;
      border-color: var(--accent);
      box-shadow: 0 0 8px var(--shadow);
    }
    button.primary {
      background-color: var(--accent-light);
      color: #000;
      border: none;
      padding: 10px 16px;
      cursor: pointer;
      border-radius: 8px;
      font-weight: 700;
      margin-top: 6px;
      transition: 0.2s;
    }
    button.primary:hover { background-color: var(--accent); transform: scale(1.02); }

    canvas#profitChart {
      display: block;
      width: 100%;
      height: 260px;
      background-color: var(--bg-panel);
      border-radius: 8px;
      padding: 10px;
      box-shadow: 0 0 12px var(--shadow);
      margin: 18px auto;
    }

    table#historyTable {
      width: 100%;
      margin: 14px auto 22px;
      border-collapse: collapse;
      background-color: var(--bg-panel);
      border-radius: 10px;
      overflow: hidden;
      box-shadow: 0 0 10px var(--shadow);
    }
    th, td {
      padding: 10px;
      border: 1px solid var(--border);
      text-align: center;
      font-size: 13px;
    }
    th { background-color: var(--accent-light); color: #000; font-weight: 700; }
    tr:nth-child(even) td { background-color: var(--bg-deep); }

    .profit { color: var(--profit); font-weight: 700; }
    .loss { color: var(--loss); font-weight: 700; }

    .filter-bar {
      max-width: 720px;
      margin: 10px auto;
      display: flex;
      gap: 10px;
      flex-wrap: wrap;
    }
    .filter-bar select, .filter-bar input {
      flex: 1;
      min-width: 150px;
    }

    .win-rate {
      background: var(--bg-deep);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      font-size: 18px;
      font-weight: 700;
      color: var(--accent);
      margin: 10px auto;
      max-width: 720px;
      box-shadow: 0 0 8px var(--shadow);
    }

    .totals {
      max-width: 720px;
      margin: 10px auto 28px;
      background-color: var(--bg-panel);
      padding: 12px;
      border-radius: 8px;
      text-align: center;
      box-shadow: 0 0 10px var(--shadow);
    }
    .totals span { display:inline-block; margin: 0 12px; font-weight:700; color:var(--text); }

    .export-buttons { text-align: center; margin-top: 12px; }
    .export-buttons button { margin: 6px; padding: 8px 12px; border-radius: 6px; border: none; cursor: pointer; background:#00cc66; color:#000; font-weight:700; }

    img.screenshot {
      width: 78px; height: 50px; object-fit: cover; border-radius: 6px; cursor: pointer;
      transition: transform .15s, box-shadow .15s; border: 1px solid rgba(255,255,255,0.03);
    }
    img.screenshot:hover { transform: scale(1.12); box-shadow: 0 6px 20px rgba(0,255,120,0.06); }

    .modal {
      position: fixed; inset: 0; display: none; align-items: center; justify-content: center;
      background: rgba(0,0,0,0.7); z-index: 2000;
    }
    .modal.active { display: flex; }
    .modal .box { max-width: 92%; max-height: 90%; background: var(--bg-panel); padding: 10px; border-radius: 8px; }
    .modal img { max-width: 100%; max-height: 80vh; display: block; border-radius: 6px; }

    .notulen-wrap { max-width: 720px; margin: 8px auto 20px; background: var(--bg-panel); padding: 14px; border-radius: 12px; }
    .notulen-header { display:flex; justify-content: space-between; align-items: center; gap: 10px; margin-bottom: 10px; }
    .notulen-header .date { color: var(--text); font-weight: 700; }
    textarea#notulenArea { width: 100%; min-height: 220px; background: var(--bg-deep); border: 1px solid var(--border); color: var(--text); padding: 10px; border-radius: 8px; resize: vertical; }
    .checklist { margin-top: 12px; background: var(--bg-deep); padding: 10px; border-radius: 8px; }
    .checklist h3 { margin: 6px 0 12px 0; }
    .checklist-item { display:flex; gap:10px; align-items:center; background: #191919; padding: 8px; border-radius: 6px; margin-bottom: 8px; }
    [data-theme="light"] .checklist-item { background: #f0f0f0; }
    .checklist-item span { flex:1; color:var(--text); outline: none; min-height:18px; }
    .checklist-item input[type="checkbox"] { transform:scale(1.25); }
    .checklist-item button.del { background:none; border:none; color:var(--loss); font-size:18px; cursor:pointer; }
    .add-btn { background:var(--accent); color:#000; border:none; padding:8px 12px; border-radius:6px; cursor:pointer; font-weight:700; }

    @media (max-width: 820px) {
      header { flex-direction: column; text-align: center; }
      .filter-bar { flex-direction: column; }
      .risk-box input, .risk-box select { width: 100%; }
      img.screenshot { width: 64px; height: 44px; }
    }
  </style>
</head>
<body data-theme="dark">

  <!-- JUDUL UTAMA -->
  <h1 class="main-title">DASHBOARD BACKTEST FOREX</h1>

  <header>
    <div class="tabs" role="tablist">
      <button id="tabJurnal" class="active" role="tab">Jurnal Backtest</button>
      <button id="tabNotulen" role="tab">Notulen & Ceklis</button>
    </div>
    <button id="themeToggle" class="theme-toggle">Light Mode</button>
  </header>

  <main>
    <!-- JURNAL SECTION -->
    <section id="sectionJurnal" class="section active">
      <div class="risk-box">
        <h3 style="margin:0 0 8px 0; color:var(--accent)">Modal & Manajemen Risiko</h3>
        <input type="number" id="modalAwal" placeholder="Modal awal ($)" step="0.01">
        <label for="riskSelect">Risk Per Trade (%)</label>
        <select id="riskSelect">
          <option value="1">1%</option>
          <option value="2">2%</option>
          <option value="3">3%</option>
          <option value="5">5%</option>
        </select>
        <div style="margin-top:10px;">
          <span class="value-box">Risk $<span id="riskValue">0.00</span></span>
        </div>
        <div style="margin-top:12px;">
          <span class="value-box">Total P&L: $<span id="totalPLDisplay">0.00</span></span>
          <span class="value-box">Balance: $<span id="balanceDisplay">0.00</span></span>
        </div>
      </div>

      <div class="filter-bar">
        <select id="filterPair"><option value="">-- Semua Pair --</option></select>
        <select id="filterStrategy"><option value="">-- Semua Strategi --</option></select>
        <input type="text" id="filterSearch" placeholder="Cari catatan...">
      </div>

      <div class="win-rate">
        Win Rate: <span id="winRateValue">0%</span> 
        (<span id="winCount">0</span> Win / <span id="totalTrades">0</span> Trades)
      </div>

      <form id="jurnalForm" class="jurnal-form">
        <label for="date">Tanggal:</label>
        <input type="date" id="date" required>

        <label for="pair">Pair Forex:</label>
        <select id="pair" required>
          <option value="">-- Pilih Pair --</option>
          <option value="EUR/USD">EUR/USD</option>
          <option value="GBP/USD">GBP/USD</option>
          <option value="USD/JPY">USD/JPY</option>
          <option value="AUD/USD">AUD/USD</option>
          <option value="USD/CAD">USD/CAD</option>
          <option value="USD/CHF">USD/CHF</option>
          <option value="NZD/USD">NZD/USD</option>
        </select>

        <label for="strategy">Strategi:</label>
        <input type="text" id="strategy" placeholder="Masukkan strategi" required>

        <div style="display:grid; grid-template-columns:1fr 1fr; gap:10px;">
          <div><label for="entry">Entry Point:</label><input type="number" id="entry" step="0.0001" required></div>
          <div><label for="exit">Exit Point:</label><input type="number" id="exit" step="0.0001" required></div>
        </div>

        <label for="resultType">Hasil:</label>
        <select id="resultType" required>
          <option value="">-- Pilih Hasil --</option>
          <option value="Profit">Profit</option>
          <option value="Loss">Loss</option>
        </select>

        <label for="amount">Jumlah ($):</label>
        <input type="number" id="amount" step="0.01" required>

        <label for="notes">Catatan:</label>
        <textarea id="notes" rows="3"></textarea>

        <label for="screenshot">Screenshot (opsional):</label>
        <input type="file" id="screenshot" accept="image/*">

        <button type="submit" class="primary">Simpan Jurnal</button>
      </form>

      <canvas id="profitChart"></canvas>

      <h2 style="text-align:center; color:var(--accent); margin-top:8px;">Riwayat Transaksi</h2>
      <table id="historyTable">
        <thead>
          <tr>
            <th>Tanggal</th>
            <th>Pair</th>
            <th>Strategi</th>
            <th>Entry</th>
            <th>Exit</th>
            <th>Hasil</th>
            <th>Jumlah ($)</th>
            <th>Catatan</th>
            <th>Screenshot</th>
          </tr>
        </thead>
        <tbody></tbody>
      </table>

      <div class="totals">
        <h3 style="margin:6px 0 8px 0; color:var(--accent)">Total Akumulasi</h3>
        <span class="profit">Profit: $<span id="totalProfit">0</span></span>
        <span class="loss">Loss: $<span id="totalLoss">0</span></span>
        <span>Saldo Akhir: $<span id="netResult">0</span></span>
      </div>

      <div class="export-buttons">
        <button id="exportExcel">Ekspor ke Excel</button>
        <button id="exportPDF">Ekspor ke PDF</button>
        <button id="clearAll" style="background:#ff6666;color:#fff;">Reset Semua</button>
      </div>
    </section>

    <!-- NOTULEN SECTION -->
    <section id="sectionNotulen" class="section">
      <div class="notulen-wrap">
        <div class="notulen-header">
          <div style="display:flex;gap:12px;align-items:center;">
            <h2 style="margin:0;color:var(--accent)">Notulen</h2>
            <div class="date" id="notulenDate"></div>
          </div>
          <div>
            <button id="saveNotulenBtn" class="add-btn">Simpan</button>
            <button id="clearNotulenBtn" class="add-btn" style="background:#f55;color:#fff;margin-left:8px;">Hapus</button>
          </div>
        </div>
        <textarea id="notulenArea" placeholder="Tulis notulen atau catatan penting..."></textarea>

        <div class="checklist">
          <h3>Daftar Ceklis</h3>
          <div id="checklistContainer"></div>
          <button class="add-btn" id="addChecklistBtn">+ Tambah Item</button>
          <button id="clearChecklistBtn" class="add-btn" style="background:#ff6666;color:#fff;margin-left:8px;">Kosongkan</button>
        </div>
      </div>
    </section>
  </main>

  <div id="imgModal" class="modal" role="dialog" aria-hidden="true">
    <div class="box">
      <button id="closeModal" style="float:right;background:none;border:none;color:var(--accent);font-weight:700;cursor:pointer;">x</button>
      <img id="modalImg" src="" alt="Screenshot penuh">
    </div>
  </div>

  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://cdn.jsdelivr.net/npm/xlsx/dist/xlsx.full.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf-autotable/3.8.0/jspdf.plugin.autotable.min.js"></script>

  <script>
    // TEMA
    const themeToggle = document.getElementById('themeToggle');
    const body = document.body;
    const savedTheme = localStorage.getItem('theme') || 'dark';
    body.setAttribute('data-theme', savedTheme);
    themeToggle.textContent = savedTheme === 'dark' ? 'Light Mode' : 'Dark Mode';

    themeToggle.addEventListener('click', () => {
      const newTheme = body.getAttribute('data-theme') === 'dark' ? 'light' : 'dark';
      body.setAttribute('data-theme', newTheme);
      localStorage.setItem('theme', newTheme);
      themeToggle.textContent = newTheme === 'dark' ? 'Light Mode' : 'Dark Mode';
    });

    // TAB
    const tabJurnal = document.getElementById('tabJurnal');
    const tabNotulen = document.getElementById('tabNotulen');
    const sectionJurnal = document.getElementById('sectionJurnal');
    const sectionNotulen = document.getElementById('sectionNotulen');

    function showJurnal() {
      tabJurnal.classList.add('active'); tabNotulen.classList.remove('active');
      sectionJurnal.classList.add('active'); sectionNotulen.classList.remove('active');
      history.replaceState(null, '', '#jurnal');
    }
    function showNotulen() {
      tabNotulen.classList.add('active'); tabJurnal.classList.remove('active');
      sectionNotulen.classList.add('active'); sectionJurnal.classList.remove('active');
      history.replaceState(null, '', '#notulen');
    }
    tabJurnal.addEventListener('click', showJurnal);
    tabNotulen.addEventListener('click', showNotulen);
    if (location.hash === '#notulen') showNotulen();

    // JOURNAL LOGIC (sama seperti sebelumnya, tidak diulang untuk singkat)
    // ... (kode JavaScript tetap sama seperti versi sebelumnya)
    // Untuk melihat JS lengkap, gunakan kode dari versi sebelumnya

    // Notulen & Checklist (sama)
  </script>
</body>
</html>
